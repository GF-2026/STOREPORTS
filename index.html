<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Reporte: Validación de Cámara</title>
  <style>
    :root{--bg:#f7fafc;--card:#ffffff;--accent:#2b6cb0;--muted:#6b7280}
    body{font-family:Inter,Segoe UI,Roboto,Arial,sans-serif;background:var(--bg);margin:0;padding:24px;color:#0f172a}
    .container{max-width:1100px;margin:0 auto}
    header{display:flex;align-items:center;gap:16px;margin-bottom:18px}
    h1{margin:0;font-size:20px}
    .card{background:var(--card);border-radius:10px;padding:18px;box-shadow:0 6px 18px rgba(15,23,42,0.06);margin-bottom:16px}
    .grid{display:grid;grid-template-columns:repeat(2,1fr);gap:12px}
    label{font-size:13px;color:var(--muted);display:block;margin-bottom:6px}
    input[type=text],input[type=number],input[type=datetime-local],select,textarea{width:100%;padding:10px;border:1px solid #e6eef6;border-radius:6px;font-size:14px}
    textarea{min-height:80px;resize:vertical}
    .section-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:10px}
    .actions{display:flex;gap:8px}
    button{background:var(--accent);color:#fff;border:0;padding:10px 12px;border-radius:8px;cursor:pointer}
    button.secondary{background:#fff;color:var(--accent);border:1px solid #cfe0f5}
    .table-wrap{overflow:auto}
    table{width:100%;border-collapse:collapse;font-size:13px}
    th,td{padding:8px;border-bottom:1px solid #eef2f7;text-align:left}
    th{background:#f1f7fb;color:#0b2235}
    .checkboxes{display:flex;flex-direction:column;gap:6px}
    .fullwidth{grid-column:1/-1}
    .muted{color:var(--muted);font-size:13px}
    @media (max-width:800px){.grid{grid-template-columns:1fr}}
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div style="width:52px;height:52px;border-radius:10px;background:linear-gradient(135deg,#e6f0fb,#dbeefe);display:flex;align-items:center;justify-content:center;color:var(--accent);font-weight:700">AV</div>
      <div>
        <h1>Formulario — Validación de Cámara</h1>
        <div class="muted">Llena el formulario y presiona "Guardar registro" o "Enviar Excel por correo".</div>
      </div>
    </header>

    <form id="reportForm" class="card">
      <!-- DATOS GENERALES -->
      <div class="section-header">
        <strong>1 – Datos generales</strong>
        <div class="muted">Campos obligatorios marcados con *</div>
      </div>
      <div class="grid">
        <div><label>Report *</label><input type="text" id="report" value="Validación de cámara" required /></div>
        <div><label>Date & Time *</label><input type="datetime-local" id="datetime" required /></div>
        <div><label>Company</label><input type="text" id="company" /></div>
        <div><label>Engineer</label><input type="text" id="engineer" /></div>
        <div><label>Phone</label><input type="text" id="phone" /></div>
        <div><label>City</label><input type="text" id="city" /></div>
        <div class="fullwidth"><label>Ubication</label><input type="text" id="ubication" /></div>
      </div>

      <hr />

      <!-- EQUIPO -->
      <div class="section-header"><strong>2 – Datos del equipo</strong></div>
      <div class="grid">
        <div><label>Description</label><input type="text" id="description" /></div>
        <div><label>Brand</label><input type="text" id="brand" /></div>
        <div><label>Model</label><input type="text" id="model" /></div>
        <div><label>Serial</label><input type="text" id="serial" /></div>
        <div><label>Control number</label><input type="text" id="controlnum" /></div>
        <div><label>Status</label><input type="text" id="status" /></div>
      </div>

      <hr />

      <!-- AMBIENTE -->
      <div class="section-header"><strong>3 – Condiciones ambientales</strong></div>
      <div class="grid">
        <div><label>Temperature (°C)</label><input type="number" step="0.1" id="temperature" /></div>
        <div><label>Humidity (%)</label><input type="number" step="0.1" id="humidity" /></div>
      </div>

      <hr />

      <!-- CHECKLIST -->
      <div class="section-header"><strong>4 – Checklist</strong></div>
      <div class="grid">
        <div class="checkboxes">
          <label><input type="checkbox" id="specs_available" /> Specs available</label>
          <label><input type="checkbox" id="voltage_plate" /> Voltage matches plate</label>
          <label><input type="checkbox" id="manuals" /> Manuals available</label>
          <label><input type="checkbox" id="refrigerant" /> Refrigerant loaded</label>
          <label><input type="checkbox" id="shock_free" /> Shock free</label>
          <label><input type="checkbox" id="supplies_installed" /> Supplies installed</label>
        </div>
      </div>

      <hr />

      <!-- MEDICIONES -->
      <div class="section-header"><strong>5 – Mediciones eléctricas</strong></div>
      <div class="grid">
        <div><label>Static LS</label><input type="number" step="0.01" id="static_ls" /></div>
        <div><label>Static HS</label><input type="number" step="0.01" id="static_hs" /></div>
        <div><label>Resistance (Ω)</label><input type="number" step="0.001" id="resistance" /></div>
        <div><label>T1–T2 (V)</label><input type="number" step="0.1" id="t1_t2" /></div>
        <div><label>T1–T3 (V)</label><input type="number" step="0.1" id="t1_t3" /></div>
        <div><label>T2–T3 (V)</label><input type="number" step="0.1" id="t2_t3" /></div>
        <div><label>To ground (V)</label><input type="number" step="0.01" id="to_ground" /></div>
      </div>

      <hr />

      <!-- OBSERVACIONES -->
      <div class="section-header"><strong>6 – Observaciones</strong></div>
      <textarea id="notes"></textarea>

      <div style="display:flex;gap:8px;margin-top:12px;justify-content:flex-end">
        <button type="button" id="saveBtn">Guardar registro</button>
        <button type="button" class="secondary" id="clearBtn">Limpiar formulario</button>
        <button type="button" id="sendExcelBtn">Enviar Excel por correo</button>
      </div>
    </form>

    <!-- TABLA -->
    <div class="card">
      <div class="section-header">
        <strong>Registros capturados</strong>
        <div class="actions">
          <button id="exportBtn">Exportar a Excel</button>
          <button class="secondary" id="downloadCsvBtn">Exportar CSV</button>
        </div>
      </div>
      <div class="table-wrap">
        <table id="recordsTable">
          <thead><tr id="tableHead"></tr></thead>
          <tbody id="tableBody"></tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- Librerías externas -->
  <script src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>


  <!-- Script principal -->
  <script>
  window.addEventListener('DOMContentLoaded', () => {
  document.getElementById('saveBtn').onclick = addRecord;
  document.getElementById('clearBtn').onclick = clearForm;
  document.getElementById('exportBtn').onclick = exportXLSX;
  document.getElementById('downloadCsvBtn').onclick = exportCSV;
  document.getElementById('sendExcelBtn').onclick = enviarExcelPorCorreo;
});
